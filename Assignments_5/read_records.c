#include <stdio.h>#include <stdlib.h>#include <string.h>#define HEADER_RECORD_SIZE 16#define PAGE_SIZE 512#define PAGE_HEADER_SIZE 64#define MAX_RECORD_SIZE 100void read_file_header(FILE *file, int *total_pages, int *head_page_num, int *head_record_num) {    fread(total_pages, sizeof(char), 2, file);    fread(head_page_num, sizeof(char), 2, file);    fread(head_record_num, sizeof(char), 2, file);}void read_page_header(FILE *file, int page_num, short *num_records, short *offsets, int max_records_num){	int page_offset = (HEADER_RECORD_SIZE + page_num*PAGE_SIZE);		fseek(file, page_offset, SEEK_SET);    fread(num_records, sizeof(char), 2, file);	fseek(file, (page_offset+8), SEEK_SET);    fread(offsets, sizeof(char), 2*max_records_num, file);}void read_record(FILE *file, int page_num, int record_num, char *record_buf){		short num_records;	int record_offset, record_size;	int max_records_num = 28;    short offsets[max_records_num];			read_page_header(file, page_num, &num_records, offsets, max_records_num);		record_offset = (HEADER_RECORD_SIZE + page_num*PAGE_SIZE) + PAGE_HEADER_SIZE;	if(record_num == 0) {		record_size = offsets[record_num]+1;	} else {		record_size = offsets[record_num] - offsets[record_num-1];		record_offset += offsets[record_num-1] + 1;  	}		fseek(file, record_offset, SEEK_SET);	fread(record_buf, sizeof(char), record_size, file);    record_buf[record_size] = '\0';  // Null-terminate the string}int main(int argc, char* argv[]){    FILE *input_file, *output_file;	int page_num, record_num;	int total_pages, head_page_num, head_record_num;	char record_buf[MAX_RECORD_SIZE+1];	char delete_mark;	short next_page_num, next_record_num;		input_file = fopen("students.dat", "rb");    if (input_file == NULL) {        perror("Failed to open students.dat");        return EXIT_FAILURE;    }    output_file = fopen("records_output.txt", "w");    if (output_file == NULL) {        perror("Failed to open records_output.txt");        fclose(input_file);        return EXIT_FAILURE;    }	page_num = atoi(argv[2]);	record_num = atoi(argv[3]);		read_file_header(input_file, &total_pages, &head_page_num, &head_record_num);	read_record(input_file, page_num, record_num, record_buf);		printf("Header: %d %d %d   ", total_pages, head_page_num, head_record_num);	fprintf(output_file, "Header: %d %d %d   ", total_pages, head_page_num, head_record_num);	if(argv[1][0] == 'd') {		memcpy(&delete_mark, record_buf, 1);		memcpy(&next_page_num, record_buf+1, 2);		memcpy(&next_record_num, record_buf+3, 2);		printf("Record: %c %d %d\n", delete_mark, next_page_num, next_record_num);		fprintf(output_file, "Record: %c %d %d\n", delete_mark, next_page_num, next_record_num);	} else {		printf("Record: %s\n", record_buf);		fprintf(output_file, "Record: %s\n", record_buf);	}  		    fclose(input_file);    return EXIT_SUCCESS;}